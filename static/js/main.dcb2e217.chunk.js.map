{"version":3,"sources":["components/placer/index.module.scss","features/tools/Tools.module.css","components/alignment/alignment.module.scss","components/modal/modal.module.css","features/text/flyingTextInput/index.module.scss","assets/icons/align-top.svg","assets/icons/align-middle.svg","assets/icons/align-bottom.svg","utils/KEYS.js","features/tools/constants.js","utils/index.js","features/tools/toolSlice.js","hooks/useShortcuts.js","components/slider/index.js","features/tools/drawSettings/index.js","components/draggable/index.js","features/tools/index.js","canvas/canvasSlice.js","features/note/noteSlice.js","components/modal/index.js","components/colorPicker/index.js","components/alignment/index.js","features/note/addNoteModal/index.js","features/draw/line.js","features/draw/index.js","components/Transformable/index.js","features/note/index.js","features/text/textSlice.js","features/text/index.js","canvas/layerManager.js","components/placer/index.js","components/IconButton/index.js","assets/icons/check.svg","assets/icons/times.svg","features/text/flyingTextInput/index.js","features/draw/useDraw.js","hooks/usePlacing.js","canvas/index.js","assets/bg-pattern2.png","canvas/scaleManager.js","app/App.js","app/rootReducer.js","app/store.js","index.js","features/note/addNoteModal/addNoteModal.module.css","components/slider/slider.module.css","features/tools/drawSettings/drawSettings.module.css","components/draggable/draggable.module.scss","components/colorPicker/colorPicker.module.scss"],"names":["module","exports","ACTIONS","esc","enter","backspace","del","all","v","h","n","p","e","z","t","space","plus","minus","meta","shift","up","down","left","right","tab","POINTER","DRAW","ERASE","NOTE","TEXT","lineColors","cn","classNames","filter","cls","trim","join","isEditable","el","isContentEditable","tagName","toLowerCase","disabled","readonly","type","getAttribute","includes","round100th","num","Math","round","Number","EPSILON","toolSlice","createSlice","name","initialState","cursor","draw","thickness","color","reducers","setTool","state","action","payload","setDrawColor","setDrawThickness","incrementThickness","decrementThickness","actions","ACTIONS_MAP","KEYS","useShortcuts","useState","lastShortcut","setLastShortcut","dispatch","useDispatch","useEffect","onKeyDown","document","activeElement","metaKey","shiftKey","key","ActionCreators","redo","undo","onKeyUp","matchingAction","setTimeout","window","addEventListener","removeEventListener","Slider","id","label","hideLabel","step","min","max","startingValue","onChange","example","className","value","setValue","styles","container","htmlFor","range","target","mapDispatchToProps","connect","tool","show","settingsContainer","slider","viewBox","width","height","xmlns","cx","cy","r","fill","x","y","px","textAnchor","dominantBaseline","triangle","colors","c","hex","MOUSE","KEYBOARD","updatePosition","dragRef","posRef","current","style","top","parseInt","transform","Draggable","title","children","startX","startY","onDragEnd","childRef","useRef","rect","isDragging","isUsingKeys","currentControl","setCurrentControl","getBoundingClientRect","onKeyMove","useCallback","pos","spaces","innerWidth","innerHeight","handleKeyMove","onMouseMove","clientX","clientY","handleMouseMove","disableMouse","body","classList","remove","onMouseUp","finalClass","props","keyMoving","ref","dragContainer","handle","onMouseDown","button","preventDefault","aria-describedby","React","cloneElement","showSettings","setShowSettings","controls","toolBtn","pointer","active","data-tooltip","onClick","aria-hidden","arrowSubMenu","text","canvasSlice","lines","items","setLines","addLine","addItem","Error","JSON","stringify","deselected","map","selected","uuidv1","updateItem","deleteItem","clearSelected","selectLines","canvas","present","noteSlice","activeNote","undefined","newNote","setActiveNote","clearActiveNote","setNewNote","clearNewNote","modalContainer","getElementById","Modal","hideTitle","onHide","bgRef","dialogRef","animatedHide","appear","bgAppear","add","querySelector","setAttribute","removeAttribute","useImperativeHandle","hide","content","bg","contains","role","aria-labelledby","aria-modal","dialog","createPortal","forwardRef","ColorPicker","palette","onSelectColor","setActive","fieldset","wrap","radio","checked","backgroundColor","svgMap","require","default","center","middle","bottom","Alignment","selectedHorizontal","selectedVertical","onChangeHorizontal","onChangeVertical","activeHoriz","setActiveHoriz","activeVert","setActiveVert","i","aria-invalid","alt","src","ColorPalette","defaultNote","fontSize","scaleX","scaleY","rotation","align","verticalAlign","matchDispatchToProps","onSave","onCancel","onClose","note","editText","setEditText","setFontSize","currentColor","setCurrentColor","textHoriz","setTextHoriz","textVert","setTextVert","noteRef","noteWrapRef","modalRef","focus","onSubmit","Object","assign","bounds","origin","textContainer","textAlign","aria-multiline","aria-required","textEdit","contentEditable","suppressContentEditableWarning","tabIndex","onInput","textContent","newAlignment","PropTypes","shape","string","isRequired","number","points","arrayOf","DrawSingleLine","line","stroke","strokeWidth","tension","lineCap","globalCompositeOperation","Draw","Transformable","enabled","onTransformEnd","onTransform","node","minWidth","minHeight","withRef","anchors","keepRatio","rotateEnabled","transformProps","nodeRef","trRef","nodes","getLayer","batchDraw","enabledAnchors","boundBoxFunc","oldBox","newBox","currentTool","to","duration","onFinish","draggable","evt","detail","shadowOffsetX","shadowOffsetY","shadowBlur","shadowEnabled","shadowColor","shadowOpacity","padding","fontFamily","fontStyle","textSlice","activeText","setActiveText","clearActiveText","currentActiveText","data","lastScale","debounce","setAttrs","lineHeight","DrawItem","item","LayerManager","Placer","onMove","placer","IconButton","icon","defaultText","FlyingTextInput","textData","inputRef","position","setPosition","setText","save","styleObj","console","log","inputContainer","autoCorrect","autoCapitalize","input","onBlur","relatedTarget","HTMLButtonElement","buttonIcon","cancel","cancelX","checkmark","connectPoints","point","getStage","getPointerPosition","lastLine","length","concat","TOOL_SIZE","splice","Array","from","useDraw","isDrawing","isMoving","useSelector","linesFromState","drawMouseDown","newLines","push","drawMouseMove","drawMouseUp","reducerSetLine","status","isIdle","isPlacing","isPlaced","placeReducer","usePlacing","toolName","useReducer","reset","placed","Konva","pixelRatio","canvasItems","editNote","stageRef","bgImageLoadded","setBgImageLoadded","notePlacing","textPlacing","currentKeyDown","bgImage","Image","onload","getContainer","find","Consumer","store","onWheel","Stage","stage","deltaY","scaleBy","oldScale","mousePointTo","newScale","scale","newPos","scaleStage","onMousemove","onMouseup","Line","listening","fillPatternImage","updatedTextData","App","combineReducers","toolReducer","undoable","canvasReducer","noteReducer","textReducer","configureStore","reducer","rootReducer","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.dcb2e217.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"placer\":\"placer_placer___P3AP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"controls\":\"Tools_controls__1Nbhf\",\"toolBtn\":\"Tools_toolBtn__2uH3c\",\"pointer\":\"Tools_pointer__1rXRd\",\"active\":\"Tools_active__3uvvl\",\"arrowSubMenu\":\"Tools_arrowSubMenu__2ucIk\",\"text\":\"Tools_text__382N8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fieldset\":\"alignment_fieldset__2_LAT\",\"radio\":\"alignment_radio__12Jza\",\"label-1\":\"alignment_label-1__3AHHS\",\"label-3\":\"alignment_label-3__3OE4L\",\"wrap\":\"alignment_wrap__2-hle\",\"label\":\"alignment_label__38TwN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bg\":\"modal_bg__3tErl\",\"bgAppear\":\"modal_bgAppear__2XsUD\",\"dialog\":\"modal_dialog__UQRek\",\"appear\":\"modal_appear__3MYo9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"inputContainer\":\"flyingTextInput_inputContainer__OjZHS\",\"input\":\"flyingTextInput_input__12fUF\",\"actions\":\"flyingTextInput_actions__iFFrY\",\"buttonIcon\":\"flyingTextInput_buttonIcon__PN6tC\",\"save\":\"flyingTextInput_save__2glmB\",\"cancel\":\"flyingTextInput_cancel__2on8H\"};","export default __webpack_public_path__ + \"static/media/align-top.66e36ea3.svg\";","export default __webpack_public_path__ + \"static/media/align-middle.c7187bf0.svg\";","export default __webpack_public_path__ + \"static/media/align-bottom.5504fcb1.svg\";","\nexport const KEYS = {\n  '0': '0',\n  '1': '1',\n  '2': '2',\n  v : 'v',\n  h : 'h',\n  n : 'n',\n  p : 'p',\n  e: 'e',\n  z: 'z',\n  t: 't',\n  space: ' ',\n  plus: '+',\n  minus: '-',\n  '[': '[',\n  ']': ']',\n  '?' : '?'\n}\n\nexport const MOVERS = {\n  up: 'ArrowUp',\n  down: 'ArrowDown',\n  left: 'ArrowLeft',\n  right: 'ArrowRight',\n  tab: 'Tab'\n}\n\nexport const ACTIONS = {\n  esc: 'Escape',\n  enter: 'Enter',\n  backspace: 'Backspace',\n  del: 'Delete'\n}\n\nexport const MODIFIERS = {\n  meta: 'Meta', // event.metaKey\n  shift: 'Shift', // event.shiftKey\n}\n\n// combine them all into one single object\nconst all = {\n  ...KEYS,\n  ...MODIFIERS,\n  ...MOVERS,\n  ...ACTIONS\n};\n\nexport default all;","export const TOOL_SIZE = 26;\n\nexport const POINTER = 'mouse-pointer';\nexport const DRAW = 'pencil';\nexport const ERASE = 'eraser';\nexport const NOTE = 'sticky-note';\nexport const TEXT = 'text';\n\nexport const lineColors = [\n  \"#FF6900\",\n  \"#FCB900\",\n  \"#7BDCB5\",\n  \"#00D084\",\n  \"#8ED1FC\",\n  \"#0693E3\",\n  \"#ABB8C3\",\n  \"#EB144C\",\n  \"#F78DA7\",\n  \"#9900EF\",\n];","/**\n * function that takes any amount of strings and filters out anything falsy and\n * returns a single joined string to be used in className attributes\n * @param  {...string} classNames\n */\nexport function cn(...classNames) {\n  return classNames\n    .filter((cls) => {\n      // we should only ever have non-empty strings in the array, everything\n      // else is ignored\n      return typeof cls === \"string\" && cls.trim() !== \"\";\n    })\n    .join(\" \")\n    .trim();\n}\n\nexport function isEditable(el) {\n  if (el.isContentEditable) return true;\n  const tagName = el.tagName.toLowerCase();\n  if (tagName === \"textarea\") return true;\n  if (tagName !== \"input\") return false;\n  if (el.disabled) return false;\n  if (el.readonly) return false;\n\n  const type = (el.getAttribute(\"type\") || \"text\").toLowerCase();\n  // if any of these input types is not supported by a browser, it will behave as input type text.\n  const inputTypes = [\n    \"date\",\n    \"datetime\",\n    \"datetime-local\",\n    \"email\",\n    \"month\",\n    \"number\",\n    \"password\",\n    \"search\",\n    \"tel\",\n    \"text\",\n    \"url\",\n    \"week\",\n  ];\n  if (inputTypes.includes(type)) return true;\n  \n  return false;\n}\n\n/**\n * Searches for the deepest child node of a starting parent node and specifically\n * looking in a specific index\n */\nexport function getDeepestChildAtIndex(startingEl, index = 0) {\n  const child = startingEl.children[index];\n  if (!child) return startingEl;\n  return getDeepestChildAtIndex(child, index);\n}\n\n/**\n * get a random number between min and max, inclusive\n * @param {number} min \n * @param {number} max \n */\nexport function ranB(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\n/**\n * round to the nearest hundredths decimal place\n * src: https://stackoverflow.com/a/11832950\n * @param {number} num \n */\nexport const round100th = num => Math.round((num + Number.EPSILON) * 100) / 100","import { createSlice } from \"@reduxjs/toolkit\";\n\nimport { POINTER } from \"features/tools/constants\";\n\nconst toolSlice = createSlice({\n  name: \"tool\",\n  initialState: {\n    cursor: POINTER,\n    draw: {\n      thickness: 5,\n      color: \"#FF6900\",\n    },\n  },\n  reducers: {\n    setTool(state, action) {\n      state.cursor = action.payload;\n    },\n    setDrawColor(state, action) {\n      state.draw.color = action.payload;\n    },\n    setDrawThickness(state, action) {\n      state.draw.thickness = action.payload;\n    },\n    incrementThickness(state) {\n      if (state.draw.thickness === 40) return;\n      state.draw.thickness = state.draw.thickness + 1;\n    },\n    decrementThickness(state) {\n      if (state.draw.thickness === 1) return;\n      state.draw.thickness = state.draw.thickness - 1;\n    },\n  },\n});\n\nexport const {\n  setTool,\n  setDrawColor,\n  setDrawThickness,\n  incrementThickness,\n  decrementThickness,\n} = toolSlice.actions;\n\nexport default toolSlice.reducer;\n","import { useEffect, useState } from \"react\";\nimport KEYS from \"utils/KEYS\";\nimport { DRAW, ERASE, NOTE, POINTER, TEXT } from \"features/tools/constants\";\n\nimport { ActionCreators } from \"redux-undo\";\nimport { useDispatch } from \"react-redux\";\nimport { isEditable } from \"utils\";\nimport { setTool, incrementThickness, decrementThickness } from \"features/tools/toolSlice\";\n\nconst ACTIONS_MAP = {};\nACTIONS_MAP[KEYS.p] = DRAW;\nACTIONS_MAP[KEYS.e] = ERASE;\nACTIONS_MAP[KEYS.v] = POINTER;\nACTIONS_MAP[KEYS.n] = NOTE;\nACTIONS_MAP[KEYS.t] = TEXT;\n\nfunction useShortcuts() {\n  const [lastShortcut, setLastShortcut] = useState(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    function onKeyDown(e) {\n      if (isEditable(document.activeElement)) {\n        return;\n      }\n\n      if (e.metaKey && e.shiftKey && e.key === KEYS.z) {\n        dispatch(ActionCreators.redo());\n        return;\n      }\n\n      if (!e.shiftKey && e.metaKey && e.key === KEYS.z) {\n        dispatch(ActionCreators.undo());\n        return;\n      }\n\n      // TODO: this should only work when certain tools are active and only for\n      // the specific active tool\n      if (e.key === KEYS[\"[\"]) {\n        dispatch(decrementThickness());\n      } else if (e.key === KEYS[\"]\"]) {\n        dispatch(incrementThickness());\n      }\n    }\n\n    function onKeyUp(e) {\n      if (isEditable(document.activeElement)) {\n        return;\n      }\n\n      const matchingAction = ACTIONS_MAP[e.key];\n      if (matchingAction) {\n        dispatch(setTool(matchingAction));\n      }\n\n      setLastShortcut(e.key);\n      setTimeout(() => {\n        setLastShortcut(null);\n      }, 200);\n    }\n\n    window.addEventListener(\"keyup\", onKeyUp);\n    window.addEventListener(\"keydown\", onKeyDown);\n\n    return function cleanup() {\n      window.removeEventListener(\"keyup\", onKeyUp);\n      window.removeEventListener(\"keydown\", onKeyDown);\n    };\n  }, [dispatch]);\n\n  return { lastShortcut };\n}\n\nexport default useShortcuts;\n","import { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { cn } from \"utils\";\nimport styles from \"./slider.module.css\";\n\nfunction Slider({\n  id,\n  label,\n  hideLabel = true,\n  step = \"1\",\n  min = \"1\",\n  max,\n  startingValue = 1,\n  onChange = (e) => {},\n  example,\n  className,\n}) {\n  const [value, setValue] = useState(startingValue);\n\n  useEffect(() => {\n    setValue(startingValue)\n  }, [startingValue])\n\n  return (\n    <div className={cn(\"form-control\", className, styles.container)}>\n      <label\n        htmlFor={id}\n        className={cn(\n          \"form-label\",\n          styles.label,\n          hideLabel && \"visually-hidden\",\n          !hideLabel && \"d-block\"\n        )}\n      >\n        {label}\n      </label>\n      <input\n        className={cn(\"form-range\", styles.range)}\n        type=\"range\"\n        id={id}\n        min={min}\n        max={max}\n        step={step}\n        value={value}\n        onChange={(e) => {\n          setValue(Number(e.target.value));\n          onChange(e);\n        }}\n      />\n      {example && <div className={styles.example}>{example(value)}</div>}\n    </div>\n  );\n}\n\nSlider.propTypes = {\n  id: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  hideLabel: PropTypes.bool,\n  step: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  min: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  max: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  startingValue: PropTypes.number,\n  onChange: PropTypes.func,\n  className: PropTypes.string,\n\n  /**\n   * renderProp: if set, it will get passed the value and must return a React.Element\n   */\n  example: PropTypes.func,\n};\n\nexport default Slider;\n","import { connect } from \"react-redux\";\nimport { TwitterPicker as ColorPicker } from \"react-color\";\nimport { cn } from \"utils\";\nimport Slider from \"components/slider\";\nimport { setDrawColor, setDrawThickness } from \"features/tools/toolSlice\";\nimport { lineColors } from \"features/tools/constants\";\nimport styles from \"./drawSettings.module.css\";\n\nfunction DrawSettings({ show = false, draw, setDrawColor, setDrawThickness }) {\n  return (\n    <div className={cn(styles.settingsContainer, show && styles.show)}>\n      <Slider\n        className={styles.slider}\n        id=\"drawThickness\"\n        label=\"Change the thickness of the drawing tool\"\n        min=\"1\"\n        max=\"40\"\n        startingValue={draw.thickness}\n        onChange={(e) => {\n          setDrawThickness(Number(e.target.value));\n        }}\n        example={(value) => (\n          <svg viewBox=\"0 0 100 100\" width=\"40\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g>\n              <circle cx=\"50%\" cy=\"50%\" r={value} fill={draw.color} />\n              <text\n                x=\"50%\"\n                y=\"50%\"\n                className={styles.px}\n                textAnchor=\"middle\"\n                dominantBaseline=\"middle\"\n              >\n                {value}\n              </text>\n            </g>\n          </svg>\n        )}\n      />\n      <ColorPicker\n        color={draw.color}\n        triangle={null}\n        colors={lineColors}\n        onChange={(c) => {\n          setDrawColor(c.hex);\n        }}\n      />\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  draw: state.tool.draw,\n});\n\nconst mapDispatchToProps = { setDrawThickness, setDrawColor };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DrawSettings);\n","import React, { useEffect, useRef, useState, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { cn } from \"utils\";\nimport KEYS from \"utils/KEYS\";\nimport styles from \"./draggable.module.scss\";\n\nconst MOUSE = \"mouse\";\nconst KEYBOARD = \"keyboard\";\n\n// TODO: explain why these numbers\nconst handleX = 7;\nconst handleY = 15;\n\n/*\n\nDuring mousemove position is constantly updated\n- sets the position on every move\n\nonMouseUp: Releasing mouse\n- removes the \"mousedown\" listener\n- sets isDragging to false\n- fires the \"onDragEnd\" function\n\n*/\n\nfunction handleKeyMove(e, width, height, pos) {\n  const spaces = e.shiftKey ? 20 : 5;\n  switch (e.key) {\n    case KEYS.right:\n      if (pos.x >= window.innerWidth - width) return pos;\n      return {\n        x: pos.x + spaces,\n        y: pos.y,\n      };\n\n    case KEYS.left:\n      if (pos.x <= 20) {\n        return pos;\n      }\n      return {\n        x: pos.x - spaces,\n        y: pos.y,\n      };\n    case KEYS.up:\n      if (pos.y <= 20) {\n        return pos;\n      }\n      return {\n        x: pos.x,\n        y: pos.y - spaces,\n      };\n    case KEYS.down:\n      if (pos.y >= window.innerHeight - height) return pos;\n      return {\n        x: pos.x,\n        y: pos.y + spaces,\n      };\n    default:\n      return pos;\n  }\n}\n\nfunction handleMouseMove(e, isDragging, width, height, pos) {\n  if (!isDragging) {\n    return pos;\n  }\n\n  let x = e.clientX;\n  let y = e.clientY;\n\n  if (x >= window.innerWidth - width) {\n    x = pos.x;\n  } else if (x <= 5) {\n    x = 5;\n  }\n\n  if (y >= window.innerHeight - height) {\n    y = pos.y;\n  } else if (y <= 5) {\n    y = 5;\n  }\n\n  return {\n    x,\n    y,\n  };\n}\n\nfunction updatePosition(dragRef, posRef) {\n  // offset the position of the handle so it doesn't jump (much) when grabbing it\n  const { x, y } = posRef.current;\n  let { top, left } = dragRef.current.style;\n  top = parseInt(top, 10);\n  left = parseInt(left, 10);\n\n  dragRef.current.style.transform = `translateX(${x - left - handleX}px) translateY(${y - top - handleY}px)`;\n}\n\n/**\n * a11y help: https://medium.com/salesforce-ux/4-major-patterns-for-accessible-drag-and-drop-1d43f64ebf09\n *\n * TODO: Aria live region\n */\n\nfunction Draggable({ id, title, children, startX = 0, startY = 0, onDragEnd = ({ x, y }) => {} }) {\n  // these refs get set only once\n  const childRef = useRef(null);\n  const rect = useRef(null);\n  const dragRef = useRef(null);\n\n  // these refs change often\n  const isDragging = useRef(false);\n  const posRef = useRef({ x: startX, y: startY });\n\n  /**\n   * This will store the x,y when key moving starts in order to handle resetting\n   * to original position when hitting escape\n   */\n  const isUsingKeys = useRef(null);\n\n  // this state switches between keyboard and mouse control handlers\n  const [currentControl, setCurrentControl] = useState(null);\n\n  /**\n   * This gets the dimensions of the draggable items just once on mount so that\n   * we can prevent the draggable item from going out of the bounds of the window\n   */\n  useEffect(() => {\n    rect.current = childRef.current.getBoundingClientRect();\n\n    if (dragRef.current) {\n      // updatePosition(dragRef, posRef);\n      // offset the position of the handle so it doesn't jump (much) when grabbing it\n      const x = posRef.current.x - handleX;\n      const y = posRef.current.y - handleY;\n\n      dragRef.current.style.top = `${y}px`;\n      dragRef.current.style.left = `${x}px`;\n    }\n  }, []);\n\n  const onKeyMove = useCallback(\n    function onKeyMove(e) {\n      posRef.current = handleKeyMove(e, rect.current.width, rect.current.height, posRef.current);\n      updatePosition(dragRef, posRef);\n    },\n    []\n  );\n\n  const onMouseMove = useCallback(\n    function onMouseMove(e) {\n      posRef.current = handleMouseMove(\n        e,\n        isDragging.current,\n        rect.current.width,\n        rect.current.height,\n        posRef.current\n      );\n      updatePosition(dragRef, posRef);\n    },\n    []\n  );\n\n  function onKeyUp(e) {\n    /**\n     * - if isUsingKeys and key was space/enter:\n     * -- sets isDragging to false\n     * -- fires the \"onDragEnd\" function\n     * -- set current control to null to put component back in idle state\n     */\n    if (isUsingKeys.current) {\n      switch (e.key) {\n        case KEYS.enter:\n        case KEYS.space:\n          onDragEnd(posRef.current);\n          isDragging.current = false;\n          isUsingKeys.current = null;\n          setCurrentControl(null);\n          break;\n        case KEYS.esc:\n          // reset to original position\n          updatePosition(dragRef, isUsingKeys);\n          isDragging.current = false;\n          isUsingKeys.current = null;\n          setCurrentControl(null);\n          break;\n        default:\n        // nothing\n      }\n      return;\n    }\n\n    /**\n     * - if !isUsingKeys and key was space/enter:\n     * -- sets isDragging to true\n     * -- sets isUsingKeys to true\n     * -- attaches \"keydown\" listener (in useEffect)\n     * -- removes \"mousemove\" listeners (in useEffect)\n     * -- attaches \"mouseup\" listener (in useEffect)\n     */\n    if (!isUsingKeys.current && (e.key === KEYS.space || e.key === KEYS.enter)) {\n      isUsingKeys.current = { ...posRef.current };\n      isDragging.current = true;\n      setCurrentControl(KEYBOARD);\n    }\n  }\n\n  useEffect(() => {\n    function disableMouse() {\n      if (isDragging.current) {\n        isDragging.current = false;\n        window.removeEventListener(\"mousemove\", onMouseMove);\n        document.body.classList.remove(\"cursor-grabbing\");\n        onDragEnd(posRef.current);\n      }\n    }\n\n    function onMouseUp() {\n      disableMouse();\n      setCurrentControl(null);\n      window.removeEventListener(\"mouseup\", onMouseUp);\n    }\n\n    /**\n     * button.onMouseDown\n     * - if mouse button click, disable Keys listeners and attach new mouse move\n     *   listeners\n     */\n\n    if (currentControl === MOUSE) {\n      window.removeEventListener(\"keydown\", onKeyMove);\n      window.addEventListener(\"mousemove\", onMouseMove);\n      window.addEventListener(\"mouseup\", onMouseUp);\n    }\n\n    /**\n     * button.onKeyUp\n     */\n    if (currentControl === KEYBOARD) {\n      disableMouse();\n      window.addEventListener(\"keydown\", onKeyMove);\n    }\n\n    return function cleanup() {\n      window.removeEventListener(\"mousemove\", onMouseMove);\n      window.removeEventListener(\"mouseup\", disableMouse);\n      window.removeEventListener(\"keydown\", onKeyMove);\n    };\n  }, [onKeyMove, onMouseMove, onDragEnd, currentControl]);\n\n  const finalClass =\n    currentControl === KEYBOARD\n      ? cn(children.props.className, styles.keyMoving)\n      : children.props.className;\n\n  return (\n    <div ref={dragRef} className={cn(styles.dragContainer)}>\n      <span id={id} className=\"visually-hidden\">\n        Press space bar to grab\n      </span>\n      <button\n        className={styles.handle}\n        onMouseDown={(e) => {\n          if (e.button === 0) {\n            e.preventDefault();\n            isDragging.current = true;\n            setCurrentControl(MOUSE);\n          }\n        }}\n        onKeyUp={onKeyUp}\n        aria-describedby={id}\n      >\n        <span className=\"visually-hidden\">{title}</span>\n      </button>\n\n      {/* There should only be one child */}\n      {React.cloneElement(children, { ref: childRef, className: finalClass })}\n    </div>\n  );\n}\n\nDraggable.propTypes = {\n  /**\n   * ID to link a11y description to button\n   */\n  id: PropTypes.string.isRequired,\n\n  /**\n   * title\n   */\n  title: PropTypes.string.isRequired,\n  children: PropTypes.node.isRequired,\n  startX: PropTypes.number,\n  startY: PropTypes.number,\n  onDragEnd: PropTypes.func,\n};\n\nexport default Draggable;\n","import { useState } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { setTool } from \"features/tools/toolSlice\";\nimport { DRAW, ERASE, NOTE, POINTER, TEXT } from \"features/tools/constants\";\nimport { cn } from \"utils\";\nimport DrawSettings from \"features/tools/drawSettings\";\nimport Draggable from \"components/draggable\";\n\nimport { ReactComponent as Pointer } from \"@fortawesome/fontawesome-free/svgs/solid/mouse-pointer.svg\";\nimport { ReactComponent as Pen } from \"@fortawesome/fontawesome-free/svgs/solid/pen.svg\";\nimport { ReactComponent as Note } from \"@fortawesome/fontawesome-free/svgs/solid/sticky-note.svg\";\nimport { ReactComponent as Eraser } from \"@fortawesome/fontawesome-free/svgs/solid/eraser.svg\";\nimport styles from \"./Tools.module.css\";\n\nfunction Tools({ setTool, cursor }) {\n  const [showSettings, setShowSettings] = useState(false);\n\n  return (\n    <Draggable\n      id=\"drag-tools\"\n      title=\"move tools anywhere on the canvas\"\n      startX={20}\n      startY={window.innerHeight * 0.2}\n    >\n      <div className={`shadow-light ${styles.controls}`}>\n        <button\n          id={`tool-${POINTER}`}\n          type=\"button\"\n          className={cn(\n            \"btn-clear\",\n            styles.toolBtn,\n            styles.pointer,\n            cursor === POINTER && styles.active\n          )}\n          data-tooltip=\"Select (V)\"\n          onClick={() => {\n            setShowSettings(false);\n            setTool(POINTER);\n          }}\n        >\n          <Pointer aria-hidden=\"true\" />\n          <span className=\"visually-hidden\">Select tool</span>\n        </button>\n        <button\n          id={`tool-${DRAW}`}\n          type=\"button\"\n          className={cn(\"btn-clear\", styles.toolBtn, cursor === DRAW && styles.active)}\n          data-tooltip=\"Draw (P)\"\n          onClick={() => {\n            setShowSettings(false);\n            if (cursor !== DRAW) {\n              setTool(DRAW);\n              return;\n            } else {\n              setShowSettings(!showSettings);\n            }\n          }}\n        >\n          <Pen />\n          <span className=\"visually-hidden\">Pen tool</span>\n          <span className={styles.arrowSubMenu} />\n        </button>\n        <DrawSettings show={cursor === DRAW && showSettings} />\n        <button\n          id={`tool-${ERASE}`}\n          type=\"button\"\n          className={cn(\"btn-clear\", styles.toolBtn, cursor === ERASE && styles.active)}\n          data-tooltip=\"Erase (E)\"\n          onClick={() => {\n            setShowSettings(false);\n            setTool(ERASE);\n          }}\n        >\n          <Eraser />\n          <span className=\"visually-hidden\">Eraser tool</span>\n        </button>\n        <button\n          id={`tool-${NOTE}`}\n          type=\"button\"\n          className={cn(\"btn-clear\", styles.toolBtn, cursor === NOTE && styles.active)}\n          data-tooltip=\"Note (N)\"\n          onClick={() => {\n            setShowSettings(false);\n            setTool(NOTE);\n          }}\n        >\n          <Note />\n          <span className=\"visually-hidden\">Add a sticky note to the canvas</span>\n        </button>\n        <button\n          id={`tool-${TEXT}`}\n          type=\"button\"\n          className={cn(\"btn-clear\", styles.toolBtn, cursor === TEXT && styles.active)}\n          data-tooltip=\"Text (T)\"\n          onClick={() => {\n            setShowSettings(false);\n            setTool(TEXT);\n          }}\n        >\n          <span aria-hidden=\"true\" className={styles.text}>\n            T\n          </span>\n          <span className=\"visually-hidden\">Add text to the canvas</span>\n        </button>\n      </div>\n    </Draggable>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  cursor: state.tool.cursor,\n});\n\nconst mapDispatchToProps = { setTool };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Tools);\n","import { createSlice } from \"@reduxjs/toolkit\";\nimport { v1 as uuidv1 } from \"uuid\";\n\n/**\n * This reducer/state will hold on the content placed on the canvas and will\n * allow us to under/redo it\n */\nconst canvasSlice = createSlice({\n  name: \"canvas\",\n  initialState: {\n    lines: [],\n    items: [],\n  },\n  reducers: {\n    /**************************************************\n     * Drawing lines\n     */\n    setLines(state, action) {\n      return {\n        ...state,\n        lines: action.payload,\n      };\n    },\n    addLine(state, action) {\n      return {\n        ...state,\n        lines: [...state.lines, action.payload],\n      };\n    },\n\n    /**************************************************\n     * all other items\n     */\n    addItem(state, action) {\n      if (!action.payload.type) {\n        throw new Error(\"item is missing a type \" + JSON.stringify(action.payload));\n      }\n\n      /**\n       * deselect any previous item\n       */\n      const deselected = state.items.map((n) => {\n        n.selected = false;\n        return n;\n      });\n\n      // give new item an id\n      action.payload.id = uuidv1();\n\n      // add item\n      state.items = [...deselected, action.payload];\n    },\n\n    updateItem(state, action) {\n      /**\n       * deselect any previous item\n       * replace item with matching ID with one in the payload\n       */\n      state.items = state.items.map((n) => {\n        n.selected = false;\n        if (n.id === action.payload.id) {\n          return action.payload;\n        }\n        return n;\n      });\n    },\n\n    deleteItem(state) {\n      // delete the currently selected note\n      state.items = state.items.filter((n) => !n.selected);\n    },\n    clearSelected(state) {\n      state.items = state.items.map((n) => {\n        n.selected = false;\n        return n;\n      });\n    },\n  },\n});\n\nexport const {\n  setLines,\n  addLine,\n  addItem,\n  updateItem,\n  deleteItem,\n  clearSelected,\n} = canvasSlice.actions;\n\nexport const selectLines = (state) => state.canvas.present.lines;\n\nexport default canvasSlice.reducer;\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst noteSlice = createSlice({\n  name: \"note\",\n  initialState: { activeNote: undefined, newNote: undefined },\n  reducers: {\n    setActiveNote(state, action) {\n      state.activeNote = action.payload;\n    },\n    clearActiveNote(state) {\n      state.activeNote = undefined;\n    },\n    setNewNote(state, action) {\n      state.newNote = action.payload;\n    },\n    clearNewNote(state) {\n      state.newNote = undefined;\n    },\n  },\n});\n\nexport const { setActiveNote, clearActiveNote, setNewNote, clearNewNote } = noteSlice.actions;\n\nexport default noteSlice.reducer;\n","import { useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport KEYS from \"utils/KEYS\";\nimport styles from \"./modal.module.css\";\n\nconst modalContainer = document.getElementById(\"modal-root\");\n\nfunction Modal({ id, title, hideTitle = false, children, onHide = () => {} }, ref) {\n  const bgRef = useRef(null);\n  const dialogRef = useRef(null);\n\n  useEffect(() => {\n    document.body.classList.add(\"has-dialog\");\n    document.querySelector(\"#root\").setAttribute(\"aria-hidden\", \"true\");\n\n    setTimeout(() => {\n      if (dialogRef.current) {\n        dialogRef.current.classList.add(styles.appear);\n      }\n      if (bgRef.current) {\n        bgRef.current.classList.add(styles.bgAppear);\n      }\n    }, 100);\n\n    return function cleanup() {\n      document.body.classList.remove(\"has-dialog\");\n      document.querySelector(\"#root\").removeAttribute(\"aria-hidden\");\n    };\n  }, []);\n\n  function animatedHide() {\n    dialogRef.current.classList.remove(styles.appear);\n    bgRef.current.classList.remove(styles.bgAppear);\n    setTimeout(onHide, 350);\n  }\n\n  function onBgKeyUp(e) {\n    if (e.key === KEYS.esc) {\n      animatedHide();\n    }\n  }\n\n  function onBgClick(e) {\n    if (e.target.classList.contains(styles.bg)) {\n      animatedHide();\n    }\n  }\n\n  useImperativeHandle(ref, () => ({\n    hide: animatedHide,\n  }));\n\n  const content = (\n    <div ref={bgRef} className={styles.bg} onKeyUp={onBgKeyUp} onClick={onBgClick}>\n      <div\n        role=\"dialog\"\n        id={id}\n        aria-labelledby={`${id}_label`}\n        aria-modal=\"true\"\n        className={styles.dialog}\n        ref={dialogRef}\n      >\n        <div id={`${id}_label`} className={hideTitle ? \"visually-hidden\" : null}>\n          {title}\n        </div>\n        {children}\n      </div>\n    </div>\n  );\n\n  return createPortal(content, modalContainer);\n}\n\nexport default forwardRef(Modal);\n","import { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { cn } from \"utils\";\nimport styles from \"./colorPicker.module.scss\";\n\nfunction ColorPicker({ className, selected, palette, onSelectColor = (color) => {} }) {\n  const [active, setActive] = useState(selected);\n\n  return (\n    <fieldset className={cn(styles.fieldset, className)}>\n      <legend className=\"visually-hidden\">Select a color</legend>\n      {palette.map((color) => (\n        <div className={`form-group ${styles.wrap}`} key={color}>\n          <input\n            className={styles.radio}\n            type=\"radio\"\n            name=\"color\"\n            id={`color-${color}`}\n            checked={color === active}\n            onChange={(e) => {\n              setActive(e.target.value);\n              onSelectColor(e.target.value);\n            }}\n            value={color}\n          />\n          <label htmlFor={`color-${color}`} style={{ backgroundColor: color }}>\n            {color}\n          </label>\n        </div>\n      ))}\n    </fieldset>\n  );\n}\n\nColorPicker.propTypes = {\n  /**\n   * Add a className to the containing fieldset to alter styles locally\n   */\n  className: PropTypes.string,\n\n  /**\n   * Set the selected color\n   */\n  selected: PropTypes.string,\n\n  /**\n   * populate the color palette\n   */\n  palette: PropTypes.arrayOf(PropTypes.string).isRequired,\n\n  /**\n   * event handler when a new color is selected\n   */\n  onSelectColor: PropTypes.func,\n};\n\nexport default ColorPicker;\n","import { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { cn } from \"utils\";\nimport styles from \"./alignment.module.scss\";\n\nconst svgMap = {\n  left: require(\"@fortawesome/fontawesome-free/svgs/solid/align-left.svg\").default,\n  center: require(\"@fortawesome/fontawesome-free/svgs/solid/align-center.svg\").default,\n  right: require(\"@fortawesome/fontawesome-free/svgs/solid/align-right.svg\").default,\n  top: require('assets/icons/align-top.svg').default,\n  middle: require('assets/icons/align-middle.svg').default,\n  bottom: require('assets/icons/align-bottom.svg').default,\n};\n\nfunction Alignment({\n  className,\n  selectedHorizontal = \"center\",\n  selectedVertical = \"middle\",\n  onChangeHorizontal,\n  onChangeVertical,\n}) {\n  const [activeHoriz, setActiveHoriz] = useState(selectedHorizontal);\n  const [activeVert, setActiveVert] = useState(selectedVertical);\n\n  return (\n    <div className={cn(\"d-flex justify-content-around\", className)}>\n      <fieldset className={styles.fieldset}>\n        <legend className=\"visually-hidden\">Select a horizontal alignment</legend>\n        {[\"left\", \"center\", \"right\"].map((h, i) => (\n          <div className={cn(\"form-group\", styles.wrap)} key={`align-horiz-${h}`}>\n            <input\n              className={styles.radio}\n              type=\"radio\"\n              name=\"horizontal\"\n              id={`align-horiz-${h}`}\n              checked={h === activeHoriz}\n              onChange={(e) => {\n                setActiveHoriz(e.target.value);\n                onChangeHorizontal(e.target.value);\n              }}\n              value={h}\n              title={h}\n            />\n            <label\n              className={cn(styles.label, styles[`label-${i + 1}`])}\n              htmlFor={`align-horiz-${h}`}\n            >\n              <img aria-invalid=\"true\" alt=\"\" src={svgMap[h]} />\n              <span className=\"visually-hidden\">{h}</span>\n            </label>\n          </div>\n        ))}\n      </fieldset>\n      <fieldset className={styles.fieldset}>\n        <legend className=\"visually-hidden\">Select a vertical alignment</legend>\n        {[\"top\", \"middle\", \"bottom\"].map((v, i) => (\n          <div className={cn(\"form-group\", styles.wrap)} key={`align-vert-${v}`}>\n            <input\n              className={styles.radio}\n              type=\"radio\"\n              name=\"vertical\"\n              id={`align-vert-${v}`}\n              checked={v === activeVert}\n              onChange={(e) => {\n                setActiveVert(e.target.value);\n                onChangeVertical(e.target.value);\n              }}\n              value={v}\n              title={v}\n            />\n            <label\n              className={cn(styles.label, styles[`label-${i + 1}`])}\n              htmlFor={`align-vert-${v}`}\n            >\n              <img aria-invalid=\"true\" alt=\"\" src={svgMap[v]} />\n              <span className=\"visually-hidden\">{v}</span>\n            </label>\n          </div>\n        ))}\n      </fieldset>\n    </div>\n  );\n}\n\nAlignment.propTypes = {\n  /**\n   * Add a className to the containing fieldset to alter styles locally\n   */\n  className: PropTypes.string,\n\n  /**\n   * Set the selected horizontal alignment\n   */\n  selectedHorizontal: PropTypes.oneOf([\"left\", \"center\", \"right\"]),\n\n  /**\n   * Set the selected vertical alignment\n   */\n  selectedVertical: PropTypes.oneOf([\"top\", \"middle\", \"bottom\"]),\n\n  onChangeHorizontal: PropTypes.func.isRequired,\n\n  onChangeVertical: PropTypes.func.isRequired,\n};\n\nexport default Alignment;\n","import { useEffect, useState, useRef } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { updateItem } from \"canvas/canvasSlice\";\nimport { setNewNote } from \"features/note/noteSlice\";\n\nimport Slider from \"components/slider\";\nimport Modal from \"components/modal\";\nimport ColorPicker from \"components/colorPicker\";\nimport Alignment from \"components/alignment\";\n\nimport { cn } from \"utils\";\nimport { NOTE } from \"features/tools/constants\";\nimport styles from \"./addNoteModal.module.css\";\n\nconst ColorPalette = [\"#feff9c\", \"#6ed2d0\", \"#def350\", \"#ff6b81\", \"#ff339a\", \"#ff992a\"];\n\nconst defaultNote = {\n  type: NOTE,\n  id: null,\n  x: null,\n  y: null,\n  width: 300,\n  height: 300,\n  text: \"\",\n  fontSize: 32,\n  color: ColorPalette[0],\n  scaleX: 0.75,\n  scaleY: 0.75,\n  rotation: 0,\n  align: \"center\",\n  verticalAlign: \"middle\",\n};\n\nfunction AddNoteModal({\n  onSave = () => {},\n  onCancel = () => {},\n  onClose = () => {}, // closing for any reason, cancel or save\n  note = defaultNote,\n  x,\n  y,\n  updateItem,\n  setNewNote,\n}) {\n  const [editText, setEditText] = useState(note.text);\n  const [fontSize, setFontSize] = useState(note.fontSize);\n  const [currentColor, setCurrentColor] = useState(note.color);\n  const [textHoriz, setTextHoriz] = useState(note.align);\n  const [textVert, setTextVert] = useState(note.verticalAlign);\n  const noteRef = useRef(null);\n  const noteWrapRef = useRef(null);\n\n  const modalRef = useRef(null);\n\n  useEffect(() => {\n    if (noteRef.current) {\n      noteRef.current.focus();\n    }\n  }, [noteRef]);\n\n  return (\n    <Modal\n      id=\"addNote\"\n      title=\"Add Sticky Note\"\n      hideTitle\n      ref={modalRef}\n      onHide={() => {\n        onClose();\n      }}\n    >\n      <div>\n        <form\n          onSubmit={(e) => {\n            e.preventDefault();\n\n            const newNote = {\n              text: editText,\n              fontSize,\n              color: currentColor,\n              align: textHoriz,\n              verticalAlign: textVert\n            };\n\n            if (!note.id) {\n              // new note\n              newNote.x = x;\n              newNote.y = y;\n              const bounds = noteWrapRef.current.getBoundingClientRect();\n              newNote.origin = { x: bounds.x, y: bounds.y };\n              setNewNote(Object.assign({}, note, newNote));\n            } else {\n              // update to existing note\n              updateItem(Object.assign({}, note, newNote));\n            }\n\n            onSave();\n            modalRef.current.hide();\n          }}\n        >\n          <div\n            ref={noteWrapRef}\n            style={{ backgroundColor: currentColor }}\n            className={cn(\"form-group\", \"flex-center\", styles.note)}\n          >\n            <label className=\"visually-hidden\" id=\"stickyNoteLabel\">\n              Enter your sticky note text\n            </label>\n            <div className={styles.textContainer}>\n              <div\n                ref={noteRef}\n                style={{\n                  fontSize: fontSize + \"px\",\n                  // @ts-ignore\n                  textAlign: textHoriz,\n                  verticalAlign: textVert\n                }}\n                role=\"textbox\"\n                aria-multiline=\"true\"\n                aria-labelledby=\"stickyNoteLabel\"\n                aria-required=\"true\"\n                className={styles.textEdit}\n                contentEditable={true}\n                suppressContentEditableWarning={true}\n                tabIndex={0}\n                onInput={(e) => {\n                  // @ts-ignore\n                  setEditText(e.target.textContent);\n                }}\n              >\n                {note.text}\n              </div>\n            </div>\n          </div>\n          <div className={styles.actions}>\n            <Slider\n              hideLabel={false}\n              id=\"noteFontSize\"\n              label=\"Change the font size\"\n              min=\"32\"\n              max=\"128\"\n              startingValue={fontSize}\n              onChange={(e) => {\n                setFontSize(Number(e.target.value));\n              }}\n            />\n            <Alignment\n              className=\"mb-3\"\n              selectedHorizontal={textHoriz}\n              selectedVertical={textVert}\n              onChangeHorizontal={(newAlignment) => {\n                setTextHoriz(newAlignment);\n              }}\n              onChangeVertical={(newAlignment) => {\n                setTextVert(newAlignment);\n              }}\n            />\n            <div className={cn(\"p-2\", styles.colors)}>\n              <ColorPicker\n                selected={currentColor}\n                palette={ColorPalette}\n                onSelectColor={(color) => {\n                  setCurrentColor(color);\n                }}\n              />\n            </div>\n            <div className=\"d-flex justify-content-end mt-4 pe-2\">\n              <button\n                type=\"button\"\n                className=\"btn btn-secondary\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  onCancel();\n                  modalRef.current.hide();\n                }}\n              >\n                cancel\n              </button>\n\n              <button className=\"btn btn-primary ms-2\" type=\"submit\">\n                save\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </Modal>\n  );\n}\n\nconst matchDispatchToProps = {\n  updateItem,\n  setNewNote,\n};\n\nexport default connect(null, matchDispatchToProps)(AddNoteModal);\n","import PropTypes from \"prop-types\";\nimport { Line } from \"react-konva\";\nimport { ERASE } from \"features/tools/constants\";\n\nexport const linePropType = PropTypes.shape({\n  tool: PropTypes.string.isRequired,\n  color: PropTypes.string.isRequired,\n  thickness: PropTypes.number.isRequired,\n  points: PropTypes.arrayOf(PropTypes.number).isRequired,\n});\n\nfunction DrawSingleLine({ line }) {\n  if (!line) return null;\n  return (\n    <Line\n      points={line.points}\n      stroke={line.color}\n      strokeWidth={line.tool === ERASE ? 20 : line.thickness}\n      tension={0.5}\n      lineCap={line.tool === ERASE ? \"square\" : \"round\"}\n      globalCompositeOperation={line.tool === ERASE ? \"destination-out\" : \"source-over\"}\n    />\n  );\n}\n\nDrawSingleLine.propTypes = {\n  line: linePropType,\n};\n\nexport default DrawSingleLine;\n","import PropTypes from \"prop-types\";\nimport DrawSingleLine, { linePropType } from \"features/draw/line\";\n\nfunction Draw({ lines = [] }) {\n  return (\n    <>\n      {lines.map((line, i) => (\n        <DrawSingleLine key={`line-${i}`} line={line} />\n      ))}\n    </>\n  );\n}\n\nDraw.propTypes = {\n  lines: PropTypes.arrayOf(linePropType),\n};\n\nexport default Draw;\n","import React, { useRef, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Transformer } from \"react-konva\";\n\nfunction Transformable({\n  enabled = false,\n  onTransformEnd,\n  onTransform = (node, e) => {},\n  minWidth = 100,\n  minHeight = 100,\n  withRef = null,\n  children,\n\n  /**\n   * opinionated Transform option defaults\n   */\n  anchors = [\"top-left\", \"top-right\", \"bottom-right\", \"bottom-left\"],\n  keepRatio = true,\n  rotateEnabled = true,\n\n  /**\n   * see docs for more Transformer options\n   * https://konvajs.org/api/Konva.Transformer.html\n   */\n  ...transformProps\n}) {\n  const nodeRef = useRef(null);\n  const trRef = useRef(null);\n\n  useEffect(() => {\n    if (enabled && trRef.current) {\n      // we need to attach transformer manually\n      trRef.current.nodes([nodeRef.current]);\n      trRef.current.getLayer().batchDraw();\n    }\n  }, [enabled]);\n\n  useEffect(() => {\n    if (typeof withRef === \"function\" && nodeRef.current) {\n      withRef(nodeRef);\n    }\n  }, [nodeRef, withRef]);\n\n  function onEnd(e) {\n    onTransformEnd(nodeRef.current, e);\n  }\n\n  function duringTransform(e) {\n    onTransform(nodeRef.current, e);\n  }\n\n  return (\n    <>\n      {/* Transformable only works on a single child */}\n      {React.cloneElement(children, {\n        ref: nodeRef,\n        onTransformEnd: onEnd,\n        onTransform: duringTransform,\n      })}\n\n      {enabled && (\n        <Transformer\n          {...transformProps}\n          ref={trRef}\n          keepRatio={keepRatio}\n          rotateEnabled={rotateEnabled}\n          enabledAnchors={anchors}\n          boundBoxFunc={(oldBox, newBox) => {\n            if (newBox.width < minWidth || newBox.height < minHeight) {\n              return oldBox;\n            }\n            return newBox;\n          }}\n        />\n      )}\n    </>\n  );\n}\n\nTransformable.propTypes = {\n  /**\n   * Toggle the transform on/off\n   */\n  enabled: PropTypes.bool,\n\n  /**\n   * set which anchors you want to add to the transform\n   * https://konvajs.org/api/Konva.Transformer.html#enabledAnchors__anchor\n   */\n  anchors: PropTypes.arrayOf(PropTypes.string),\n\n  /**\n   * set should we keep ratio while resize anchors at corner\n   * https://konvajs.org/api/Konva.Transformer.html#keepRatio__anchor\n   */\n  keepRatio: PropTypes.bool,\n\n  /**\n   * set ability to rotate.\n   */\n  rotateEnabled: PropTypes.bool,\n\n  /**\n   * callback when transform has been completed. It will get pass 2 args:\n   * (currentNode, event)\n   */\n  onTransformEnd: PropTypes.func,\n\n  /**\n   * set a min width to the element\n   */\n  minWidth: PropTypes.number,\n\n  /**\n   * set a min height to the element\n   */\n  minHeight: PropTypes.number,\n\n  /**\n   * runs a function any time the child ref changes\n   */\n  withRef: PropTypes.func,\n\n  /**\n   * Must be a single child and a Konva react element\n   */\n  children: PropTypes.node.isRequired,\n};\n\nexport default Transformable;\n","import { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { Rect, Group, Text } from \"react-konva\";\nimport { addItem, updateItem } from \"canvas/canvasSlice\";\nimport { setActiveNote, clearNewNote } from \"features/note/noteSlice\";\nimport { POINTER } from \"features/tools/constants\";\nimport Transformable from \"components/Transformable\";\n\nexport const notePropTypes = PropTypes.shape({\n  id: PropTypes.string,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  text: PropTypes.string.isRequired,\n  fontSize: PropTypes.number.isRequired,\n  color: PropTypes.string.isRequired,\n  scaleX: PropTypes.number,\n  scaleY: PropTypes.number,\n  rotation: PropTypes.number,\n  align: PropTypes.string,\n  verticalAlign: PropTypes.string\n});\n\nfunction Note({ note, setActiveNote, currentTool, clearNewNote, addItem, updateItem }) {\n  function onClick(e) {\n    /* handle double-click which puts the note into edit mode */\n    if (e.evt.detail === 2) {\n      setActiveNote(note);\n      return;\n    }\n  }\n\n  function setSelected(e) {\n    /* handle select and transform */\n    if (e.evt.detail === 1 && !note.selected) {\n      updateItem({\n        ...note,\n        selected: true,\n      });\n    }\n  }\n\n  function onDragEnd(e) {\n    updateItem({\n      ...note,\n      x: e.target.x(),\n      y: e.target.y(),\n    });\n  }\n\n  function onTransformEnd(node) {\n    updateItem({\n      ...note,\n      x: node.x(),\n      y: node.y(),\n      scaleX: node.scaleX(),\n      scaleY: node.scaleY(),\n      rotation: node.rotation(),\n    });\n  }\n\n  return (\n    <Transformable\n      enabled={note.selected && currentTool === POINTER}\n      onTransformEnd={onTransformEnd}\n      withRef={(noteRef) => {\n        /**\n         * This will handle animating the note when first added to the canvas\n         * and then once done it'll remove the note from the temporary \"newNote\"\n         * state and move it to the main undoable state\n         */\n        if (noteRef.current && note.origin) {\n          noteRef.current.to({\n            x: note.x,\n            y: note.y,\n            duration: 0.2,\n            onFinish: () => {\n              addItem({\n                ...note,\n                origin: null,\n              });\n              clearNewNote();\n            },\n          });\n        }\n      }}\n    >\n      <Group\n        draggable={currentTool === POINTER}\n        x={note.origin ? note.origin.x : note.x}\n        y={note.origin ? note.origin.y : note.y}\n        rotation={note.rotation}\n        onClick={onClick}\n        onDragEnd={onDragEnd}\n        onMouseDown={setSelected}\n        scaleX={note.scaleX}\n        scaleY={note.scaleY}\n      >\n        <Rect\n          fill={note.color}\n          width={note.width}\n          height={note.height}\n          shadowOffsetX={0}\n          shadowOffsetY={5}\n          shadowBlur={3}\n          shadowEnabled={true}\n          shadowColor=\"#3c4043\"\n          shadowOpacity={0.26}\n        />\n        <Text\n          width={note.width}\n          height={note.height}\n          padding={10}\n          text={note.text}\n          fontSize={note.fontSize}\n          fontFamily=\"sans-serif\"\n          fill=\"#000000\"\n          align={note.align}\n          verticalAlign={note.verticalAlign}\n          fontStyle=\"bold\"\n        />\n      </Group>\n    </Transformable>\n  );\n}\n\nNote.propTypes = {\n  note: notePropTypes.isRequired,\n  updateItem: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state) => ({\n  currentTool: state.tool.cursor,\n});\n\nconst matchDispatchToProps = {\n  addItem,\n  updateItem,\n  setActiveNote,\n  clearNewNote,\n};\n\nexport default connect(mapStateToProps, matchDispatchToProps)(Note);\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst textSlice = createSlice({\n  name: \"text\",\n  initialState: { activeText: undefined },\n  reducers: {\n    setActiveText(state, action) {\n      state.activeText = action.payload;\n    },\n    clearActiveText(state) {\n      state.activeText = undefined;\n    },\n  },\n});\n\nexport const { setActiveText, clearActiveText } = textSlice.actions;\n\nexport default textSlice.reducer;\n","import { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { Text } from \"react-konva\";\nimport debounce from \"lodash-es/debounce\";\nimport { updateItem } from \"canvas/canvasSlice\";\nimport { setActiveText } from \"features/text/textSlice\";\nimport { round100th } from \"utils\";\nimport { POINTER } from \"features/tools/constants\";\nimport Transformable from \"components/Transformable\";\n\nexport const textPropTypes = PropTypes.shape({\n  id: PropTypes.string,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  text: PropTypes.string,\n  fontSize: PropTypes.number.isRequired,\n  color: PropTypes.string.isRequired,\n  scaleX: PropTypes.number,\n  scaleY: PropTypes.number,\n  rotation: PropTypes.number,\n});\n\nfunction TextSingle({ data, updateItem, setActiveText, currentTool, currentActiveText }) {\n  const lastScale = useRef({ scaleX: 1, scaleY: 1 });\n\n  function onClick(e) {\n    /* handle double-click which puts the text into edit mode */\n    if (e.evt.detail === 2) {\n      setActiveText(data);\n      return;\n    }\n  }\n\n  function setSelected(e) {\n    /* handle select and transform */\n    if (e.evt.detail === 1 && !data.selected) {\n      updateItem({\n        ...data,\n        selected: true,\n      });\n    }\n  }\n\n  function onDragEnd(e) {\n    updateItem({\n      ...data,\n      x: e.target.x(),\n      y: e.target.y(),\n    });\n  }\n\n  function onTransformEnd(node) {\n    const scaleX = round100th(node.scaleX());\n    const scaleY = round100th(node.scaleY());\n\n    updateItem({\n      ...data,\n      x: node.x(),\n      y: node.y(),\n      scaleX,\n      scaleY,\n      rotation: node.rotation(),\n      // width: node.width(),\n    });\n  }\n\n  const onTransform = debounce((node) => {\n    const scaleX = round100th(node.scaleX());\n    const scaleY = round100th(node.scaleY());\n    // console.log(scaleX, scaleY, lastScale.current);\n\n    if (scaleX === lastScale.current.scaleX && scaleY === lastScale.current.scaleY) {\n      return;\n    }\n\n    if (scaleX !== lastScale.current.scaleX && scaleY === lastScale.current.scaleY) {\n      node.setAttrs({\n        scaleX: lastScale.current.scaleX,\n        width: Math.max(node.width() * scaleX, 40),\n      });\n      return;\n    }\n\n    lastScale.current = { scaleX, scaleY };\n  }, 5);\n\n  return (\n    <Transformable\n      anchors={[\n        \"top-left\",\n        \"top-right\",\n        \"bottom-left\",\n        \"bottom-right\",\n        \"middle-left\",\n        \"middle-right\",\n      ]}\n      // anchorCornerRadius={5}\n      minWidth={40}\n      minHeight={40}\n      keepRatio={true}\n      enabled={data.selected && currentTool === POINTER && currentActiveText?.id !== data.id}\n      onTransformEnd={onTransformEnd}\n      onTransform={onTransform}\n    >\n      <Text\n        draggable={currentTool === POINTER}\n        x={data.x}\n        y={data.y}\n        rotation={data.rotation}\n        onClick={onClick}\n        onDragEnd={onDragEnd}\n        onMouseDown={setSelected}\n        scaleX={data.scaleX}\n        scaleY={data.scaleY}\n        width={data.width}\n        height={data.height}\n        text={currentActiveText?.id === data.id ? \"\" : data.text}\n        fontSize={data.fontSize}\n        fontFamily=\"sans-serif\"\n        fill=\"#000000\"\n        align=\"left\"\n        verticalAlign=\"top\"\n        fontStyle=\"bold\"\n        lineHeight={1.5}\n      />\n    </Transformable>\n  );\n}\n\nTextSingle.propTypes = {\n  data: textPropTypes,\n  updateItem: PropTypes.func,\n  setActiveText: PropTypes.func,\n  currentTool: PropTypes.string,\n};\n\nconst mapStateToProps = (state) => ({\n  currentTool: state.tool.cursor,\n  currentActiveText: state.text.activeText,\n});\n\nconst matchDispatchToProps = {\n  updateItem,\n  setActiveText,\n};\n\nexport default connect(mapStateToProps, matchDispatchToProps)(TextSingle);\n","import { Layer } from \"react-konva\";\nimport Draw from \"features/draw\";\nimport Note from \"features/note\";\nimport Text from \"features/text\";\nimport { NOTE, TEXT } from \"features/tools/constants\";\n\nfunction DrawItem({ item }) {\n  switch (item.type) {\n    case NOTE:\n      return <Note note={item} key={item.id} />;\n    case TEXT:\n      return <Text data={item} key={item.id} />;\n    default:\n      return null;\n  }\n}\n\n/**\n * TODO: merge state into one array so that order can be manipulated\n */\nfunction LayerManager({ items, lines, newNote }) {\n  return (\n    <Layer>\n      <Draw lines={lines} />\n      {items.map((item) => (\n        <DrawItem item={item} key={item.id} />\n      ))}\n      {newNote && <Note note={newNote} />}\n    </Layer>\n  );\n}\n\nexport default LayerManager;\n","import { useEffect, useRef } from \"react\";\n// import PropTypes from \"prop-types\";\nimport { ACTIONS } from \"utils/KEYS\";\nimport styles from \"./index.module.scss\";\n\nfunction Placer({ width, height, onFinish, onCancel }) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    function onMove(e) {\n      if (ref.current) {\n        ref.current.style.top = `${e.clientY}px`;\n        ref.current.style.left = `${e.clientX}px`;\n      }\n    }\n\n    function onClick(e) {\n      onFinish(e.clientX, e.clientY, e);\n    }\n\n    function onKeyUp(e) {\n      if (e.key === ACTIONS.esc) {\n        onCancel();\n      }\n    }\n\n    window.addEventListener(\"mousemove\", onMove);\n    window.addEventListener(\"click\", onClick);\n    window.addEventListener(\"keyup\", onKeyUp);\n\n    return function cleanup() {\n      window.removeEventListener(\"mousemove\", onMove);\n      window.removeEventListener(\"click\", onClick);\n      window.removeEventListener(\"keyup\", onKeyUp);\n    };\n  }, [onCancel, onFinish]);\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        width: `${width}px`,\n        height: `${height}px`,\n      }}\n      className={styles.placer}\n    />\n  );\n}\n\nexport default Placer;\n","/**\n * Accessible Icon Button\n * \n * research: \n * https://www.sarasoueidan.com/blog/accessible-icon-buttons/\n * https://www.scottohara.me/blog/2019/05/22/contextual-images-svgs-and-a11y.html\n * \n */\n\nfunction IconButton({ text, icon, onClick, ...props }) {\n  return (\n    <button {...props} type=\"button\" onClick={onClick}>\n      <img src={icon} alt=\"\" aria-hidden=\"true\" />\n      <span className=\"visually-hidden\" role=\"presentation\">{text}</span>\n    </button>\n  );\n}\n\nexport default IconButton;\n","export default __webpack_public_path__ + \"static/media/check.f3aa198b.svg\";","export default __webpack_public_path__ + \"static/media/times.c302e2b3.svg\";","import { useEffect, useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Draggable from \"components/draggable\";\nimport KEYS from \"utils/KEYS\";\nimport { TEXT } from \"features/tools/constants\";\nimport { textPropTypes } from \"features/text\";\nimport IconButton from \"components/IconButton\";\nimport checkmark from \"assets/icons/check.svg\";\nimport cancelX from \"assets/icons/times.svg\";\nimport styles from \"./index.module.scss\";\nimport { cn } from \"utils\";\n\nconst defaultText = {\n  type: TEXT,\n  x: 0,\n  y: 0,\n  width: null,\n  height: null,\n  text: \"\",\n  fontSize: 32,\n  color: \"#000000\",\n  scaleX: 1,\n  scaleY: 1,\n  rotation: 0,\n};\n\nfunction FlyingTextInput({ x = 0, y = 0, textData = defaultText, onSave, onCancel }) {\n  const inputRef = useRef(null);\n  const [position, setPosition] = useState({ x, y });\n  const [text, setText] = useState(textData.text);\n\n  useEffect(()=> {\n    if (inputRef.current) {\n      inputRef.current.focus()\n    }\n  }, [])\n\n  function onKeyUp(e) {\n    if (e.key === KEYS.esc) {\n      onCancel();\n      return;\n    }\n\n    setText(e.target.textContent);\n  }\n\n  function save() {\n    if (!text.trim()) {\n      onCancel();\n      return;\n    }\n    const rect = inputRef.current.getBoundingClientRect();\n    onSave({\n      ...textData,\n      ...position,\n      width: rect.width,\n      height: rect.height,\n      text: text.trim(),\n    });\n  }\n\n  const styleObj = textData.width ? { width: textData.width } : { width: 400 };\n\n  return (\n    <Draggable\n      id=\"flyingTextInput\"\n      title=\"Move text input anywhere on the canvas\"\n      startX={x}\n      // 20px padding-top of container + 5px padTop of input\n      startY={y - 25}\n      onDragEnd={(pos) => {\n        console.log(pos, \"flyingtext input drag end\");\n        setPosition(pos);\n      }}\n    >\n      <div className={styles.inputContainer}>\n        <div className=\"visually-hidden\" id=\"enterText\">\n          Add text to canvas\n        </div>\n        <div\n          ref={inputRef}\n          style={styleObj}\n          autoCorrect=\"off\"\n          autoCapitalize=\"off\"\n          role=\"textbox\"\n          aria-multiline=\"true\"\n          aria-labelledby=\"enterText\"\n          className={styles.input}\n          contentEditable={true}\n          suppressContentEditableWarning={true}\n          tabIndex={0}\n          onKeyUp={onKeyUp}\n          onBlur={(e) => {\n            if (\n              e.relatedTarget instanceof HTMLButtonElement &&\n              e.relatedTarget.id === \"flyingText_cancel\"\n            ) {\n              console.log(e.relatedTarget.id)\n              return;\n            } else {\n              save()\n            }\n          }}\n        >\n          {textData.text}\n        </div>\n        <div className={styles.actions}>\n          <IconButton\n            id=\"flyingText_cancel\"\n            className={cn(\"btn-clear\", styles.buttonIcon, styles.cancel)}\n            text=\"cancel\"\n            icon={cancelX}\n            onClick={(e) => {\n              e.preventDefault();\n              onCancel();\n            }}\n          />\n          <IconButton\n            id=\"flyingText_save\"\n            className={cn(\"btn-clear\", styles.buttonIcon, styles.save)}\n            text=\"save\"\n            icon={checkmark}\n            onClick={save}\n          />\n        </div>\n      </div>\n    </Draggable>\n  );\n}\n\nFlyingTextInput.propTypes = {\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  text: textPropTypes,\n  onSave: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n};\n\nexport default FlyingTextInput;\n","import { useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectLines, setLines as reducerSetLine } from \"canvas/canvasSlice\";\nimport { DRAW, TOOL_SIZE } from \"features/tools/constants\";\n\nconst eraserOffset = TOOL_SIZE / 2;\n\nfunction connectPoints(e, tool, lines) {\n  const point = e.target.getStage().getPointerPosition();\n  let lastLine = lines[lines.length - 1];\n\n  /**\n   * Offset for the Draw tool to get it to match up with the tip of the pen\n   * Offset for the Erase tool to center it within the square\n   */\n  if (tool === DRAW) {\n    lastLine.points = lastLine.points.concat([point.x, point.y + TOOL_SIZE]);\n  } else {\n    lastLine.points = lastLine.points.concat([point.x + eraserOffset, point.y + eraserOffset]);\n  }\n\n  // replace last\n  lines.splice(lines.length - 1, 1, lastLine);\n  return Array.from(lines);\n}\n\n/**\n * useDraw hook\n * for better performance this hook keeps the lines in its own internal state and\n * updates global redux state only on MouseUp.\n */\nfunction useDraw() {\n  const [lines, setLines] = useState([]);\n  const isDrawing = useRef(false);\n  const isMoving = useRef(false);\n  const dispatch = useDispatch();\n\n  // @ts-ignore\n  const color = useSelector((state) => state.tool.draw.color);\n  // @ts-ignore\n  const thickness = useSelector((state) => state.tool.draw.thickness);\n  // @ts-ignore\n  const tool = useSelector((state) => state.tool.cursor);\n  const linesFromState = useSelector(selectLines);\n\n  /**\n   * When lines in redux state are updated because of undo/redo then we need\n   * to update the local state here\n   */\n  useEffect(() => {\n    setLines(linesFromState);\n  }, [linesFromState, setLines]);\n\n  const drawMouseDown = (e) => {\n    if (e.evt.button !== 0) return;\n\n    isDrawing.current = true;\n    const pos = e.target.getStage().getPointerPosition();\n\n    if (tool === DRAW) {\n      const newLines = Array.from(lines);\n      newLines.push({ tool, color, thickness, points: [pos.x, pos.y + TOOL_SIZE] });\n      setLines(newLines);\n    } else {\n      const newLines = Array.from(lines);\n      newLines.push({\n        tool,\n        color,\n        thickness,\n        points: [pos.x + eraserOffset, pos.y + eraserOffset],\n      });\n      setLines(newLines);\n    }\n  };\n\n  const drawMouseMove = (e) => {\n    // no drawing - skipping\n    if (!isDrawing.current) {\n      return;\n    }\n    isMoving.current = true;\n    setLines(connectPoints(e, tool, lines));\n  };\n\n  const drawMouseUp = (e) => {\n    isDrawing.current = false;\n\n    if (!isMoving.current) {\n      setLines(connectPoints(e, tool, lines));\n    } else {\n      isMoving.current = false;\n    }\n\n    setTimeout(() => {\n      dispatch(reducerSetLine(lines));\n    }, 1);\n  };\n\n  return {\n    lines,\n    drawMouseDown,\n    drawMouseMove,\n    drawMouseUp,\n  };\n}\n\nexport default useDraw;\n","import { useReducer } from \"react\";\nimport { useEffect } from \"react\";\n\nconst initialState = {\n  status: {\n    isIdle: true,\n    isPlacing: false,\n    isPlaced: false,\n  },\n  position: { x: 0, y: 0 },\n};\n\n/**\n * @param {initialState} state\n * @param {{type: 'IDLE' | 'PLACING' | 'PLACED', payload?: {x: number, y: number}}} action\n */\nfunction placeReducer(state, action) {\n  switch (action.type) {\n    case \"IDLE\": {\n      return {\n        ...state,\n        status: {\n          isIdle: true,\n          isPlacing: false,\n          isPlaced: false,\n        },\n      };\n    }\n    case \"PLACING\": {\n      return {\n        ...state,\n        status: {\n          isIdle: false,\n          isPlacing: true,\n          isPlaced: false,\n        },\n      };\n    }\n    case \"PLACED\": {\n      return {\n        position: { ...action.payload },\n        status: {\n          isIdle: false,\n          isPlacing: false,\n          isPlaced: true,\n        },\n      };\n    }\n    default: {\n      throw new Error(`Unhandled action: ${action}`);\n    }\n  }\n}\n\nfunction usePlacing(toolName, currentTool) {\n  const [state, dispatch] = useReducer(placeReducer, initialState);\n\n  function reset() {\n    dispatch({ type: \"IDLE\" });\n  }\n\n  /**\n   * put into PLACED state and also set x,y position coordinates\n   * @param {number} x\n   * @param {number} y\n   */\n  function placed(x, y) {\n    dispatch({ type: \"PLACED\", payload: { x, y } });\n  }\n\n  /**\n   * Listens for changes in the hook arguments and dispatches appropriate\n   * actions\n   */\n  useEffect(() => {\n    if (state.status.isIdle && toolName === currentTool) {\n      dispatch({ type: \"PLACING\" });\n      return;\n    }\n\n    if (toolName !== currentTool && state.status.isPlacing) {\n      reset();\n    }\n  }, [currentTool, state.status.isIdle, state.status.isPlacing, toolName]);\n\n  return {\n    state: state.status,\n    position: state.position,\n    reset,\n    placed,\n  };\n}\n\nexport default usePlacing;\n","import { useEffect, useState, useRef } from \"react\";\nimport { Stage, Rect, Layer } from \"react-konva\";\nimport { connect, ReactReduxContext, Provider } from \"react-redux\";\n// import debounce from \"lodash-es/debounce\";\n\n// commponents\nimport Tools from \"features/tools\";\nimport AddNoteModal from \"features/note/addNoteModal\";\nimport LayerManager from \"canvas/layerManager\";\nimport Placer from \"components/placer\";\nimport FlyingTextInput from \"features/text/flyingTextInput\";\n\n// state\nimport { setTool } from \"features/tools/toolSlice\";\nimport { clearActiveNote } from \"features/note/noteSlice\";\nimport { addItem, deleteItem, updateItem, clearSelected } from \"canvas/canvasSlice\";\nimport { clearActiveText } from \"features/text/textSlice\";\n\n// other\nimport { DRAW, ERASE, NOTE, POINTER, TEXT } from \"features/tools/constants\";\nimport useDraw from \"features/draw/useDraw\";\nimport usePlacing from \"hooks/usePlacing\";\nimport bgPattern from \"assets/bg-pattern2.png\";\nimport KEYS from \"utils/KEYS\";\nimport { scaleStage } from \"canvas/scaleManager\";\n\n// for retina perf, set tip #9 https://konvajs.org/docs/performance/All_Performance_Tips.html\nimport Konva from \"konva\";\nKonva.pixelRatio = 1;\n\nconst STAGE_WIDTH = 3800;\nconst STAGE_HEIGHT = 3105;\nconst scaleBy = 1.05;\n\nfunction Canvas({\n  currentTool,\n  setTool,\n  canvasItems,\n  editNote,\n  clearActiveNote,\n  newNote,\n  lastShortcut,\n  clearActiveText,\n  editText,\n  deleteItem,\n  addItem,\n  updateItem,\n  clearSelected,\n}) {\n  const stageRef = useRef(null);\n  const { lines, drawMouseDown, drawMouseMove, drawMouseUp } = useDraw();\n  const [bgImageLoadded, setBgImageLoadded] = useState(false);\n  const notePlacing = usePlacing(NOTE, currentTool);\n  const textPlacing = usePlacing(TEXT, currentTool);\n  const currentKeyDown = useRef(null);\n\n  const bgImage = new Image();\n  bgImage.onload = () => {\n    setBgImageLoadded(true);\n  };\n  bgImage.src = bgPattern;\n\n  useEffect(() => {\n    let container = null;\n\n    function onKeyUp(e) {\n      currentKeyDown.current = null;\n      if (e.key === KEYS.del || e.key === KEYS.backspace) {\n        deleteItem();\n      }\n    }\n\n    function onKeyDown(e) {\n      currentKeyDown.current = e.key;\n    }\n\n    if (stageRef.current) {\n      container = stageRef.current.getContainer();\n      container.addEventListener(\"keyup\", onKeyUp);\n      container.addEventListener(\"keydown\", onKeyDown);\n    }\n\n    return function cleanup() {\n      if (container) {\n        container.removeEventListener(\"keyup\", onKeyUp);\n        container.removeEventListener(\"keydown\", onKeyDown);\n      }\n    };\n  }, [deleteItem]);\n\n  /**\n   * This effect handles changes in the last shortcut key\n   */\n  useEffect(() => {\n    if (lastShortcut === KEYS.esc) {\n      if (notePlacing.state.isPlacing) {\n        notePlacing.reset();\n      } else if (textPlacing.state.isPlacing) {\n        textPlacing.reset();\n      } else if (canvasItems.items.find((e) => e.selected)) {\n        clearSelected();\n      }\n    }\n  }, [lastShortcut, notePlacing, textPlacing, canvasItems.items, clearSelected]);\n\n  return (\n    <>\n      <ReactReduxContext.Consumer>\n        {({ store }) => (\n          <Stage\n            ref={stageRef}\n            width={STAGE_WIDTH}\n            height={STAGE_HEIGHT}\n            // x={(STAGE_WIDTH / 2 - window.innerWidth / 2) * -1}\n            // y={(STAGE_HEIGHT / 2 - window.innerHeight / 2) * -1}\n            tabIndex={0}\n            // onDragMove={(e) => {\n            //   const x = e.target.x();\n            //   const y = e.target.y();\n            //   console.log(x,y)\n            //   if (x < 0) {\n            //     e.target.x(0)\n            //   }\n            //   if (y < 0) {\n            //     e.target.y(0)\n            //   }\n            // }}\n            onWheel={(e) => {\n              e.evt.preventDefault();\n              if (e.target instanceof Konva.Stage) {\n                scaleStage(e.target, e.evt.deltaY, scaleBy);\n              }\n            }}\n            onMouseDown={(e) => {\n              if (currentKeyDown.current === KEYS.space) {\n                e.target.draggable(true);\n              } else if (currentTool === DRAW || currentTool === ERASE) {\n                drawMouseDown(e);\n              }\n            }}\n            onMousemove={(e) => {\n              if (currentTool === DRAW || currentTool === ERASE) {\n                drawMouseMove(e);\n              }\n            }}\n            onMouseup={(e) => {\n              e.target.draggable(false);\n\n              if (currentTool === DRAW || currentTool === ERASE) {\n                drawMouseUp(e);\n              }\n              // mimic \"blur\" off any selected item to unselect it\n              if (e.target instanceof Konva.Stage || e.target instanceof Konva.Line) {\n                clearSelected();\n              }\n            }}\n            className={`whiteboard cursor-${currentTool}`}\n          >\n            {/* Background pattern layer */}\n            <Layer listening={false}>\n              {bgImageLoadded && (\n                <Rect\n                  x={0}\n                  y={0}\n                  width={STAGE_WIDTH}\n                  height={STAGE_HEIGHT}\n                  fillPatternImage={bgImage}\n                  listening={false}\n                />\n              )}\n            </Layer>\n            <Provider store={store}>\n              <LayerManager items={canvasItems.items} lines={lines} newNote={newNote} />\n            </Provider>\n          </Stage>\n        )}\n      </ReactReduxContext.Consumer>\n\n      {notePlacing.state.isPlacing && (\n        <Placer\n          width={300 * 0.75}\n          height={300 * 0.75}\n          onFinish={(x, y) => {\n            notePlacing.placed(x, y);\n          }}\n          onCancel={() => {\n            notePlacing.reset();\n            setTool(POINTER);\n          }}\n        />\n      )}\n\n      {textPlacing.state.isPlacing && (\n        <Placer\n          width=\"400\"\n          height=\"80\"\n          onFinish={(x, y) => {\n            textPlacing.placed(x, y);\n          }}\n          onCancel={() => {\n            textPlacing.reset();\n            setTool(POINTER);\n          }}\n        />\n      )}\n\n      <Tools />\n\n      {textPlacing.state.isPlaced && (\n        <FlyingTextInput\n          x={textPlacing.position.x}\n          y={textPlacing.position.y}\n          onSave={(text) => {\n            addItem(text);\n            setTool(POINTER);\n            clearActiveText();\n            textPlacing.reset();\n          }}\n          onCancel={() => {\n            setTool(POINTER);\n            clearActiveText();\n            textPlacing.reset();\n          }}\n        />\n      )}\n\n      {editText && (\n        <FlyingTextInput\n          x={editText.x}\n          y={editText.y}\n          textData={editText}\n          onSave={(updatedTextData) => {\n            updateItem(updatedTextData);\n            setTool(POINTER);\n            clearActiveText();\n          }}\n          onCancel={() => {\n            setTool(POINTER);\n            clearActiveText();\n          }}\n        />\n      )}\n\n      {(notePlacing.state.isPlaced || editNote) && (\n        <AddNoteModal\n          note={editNote}\n          x={notePlacing.position.x}\n          y={notePlacing.position.y}\n          onClose={() => {\n            setTool(POINTER);\n            clearActiveNote();\n            notePlacing.reset();\n          }}\n        />\n      )}\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  currentTool: state.tool.cursor,\n  canvasItems: state.canvas.present,\n  editNote: state.note.activeNote,\n  newNote: state.note.newNote,\n  editText: state.text.activeText,\n});\n\nconst mapDispatchToProps = {\n  setTool,\n  clearActiveNote,\n  clearActiveText,\n  deleteItem,\n  addItem,\n  updateItem,\n  clearSelected,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas);\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAB50lEQVR4Xu3VPU9UUQAG4UMClAQlrBRrIVJLKf+/glJqPgq2kDWCoVsw0YSCim4p5obn/oCTuTN5z9lYrVb/hi9jYEOQTItnEEFaPQSJ9RBEkJqBGI83RJCYgRiOhQgSMxDDsRBBYgZiOBYiSMxADMdCBIkZiOFYiCAxAzEcCxEkZiCGYyGCxAzEcCxEkJiBGI6FCBIzEMOxEEFiBmI4FiJIzEAMx0IEiRmI4ViIIDEDMRwLESRmIIZjIYLEDMRwLESQmIEYjoUIEjMQw5nMQh6f/o7F7Z+x/P0wZns7Y/5pd2xvbcZ0ro8zmSBXN7/G2fnFyx9//3Y0Dj/vr28gdsJkgpz+uBzXi+WLvi/z2Tg5/hrTuT7OZIJYyPqx3/SE5zfk5/1Y3j2M2cedMT/44A15U8MOe9XAZK6s99JPkFhpQQSJGYjhWIggMQMxHAsRJGYghmMhgsQMxHAsRJCYgRiOhQgSMxDDsRBBYgZiOBYiSMxADMdCBIkZiOFYiCAxAzEcCxEkZiCGYyGCxAzEcCxEkJiBGI6FCBIzEMOxEEFiBmI4FiJIzEAMx0IEiRmI4ViIIDEDMRwLESRmIIZjIYLEDMRwLESQmIEYjoUIEjMQw7EQQWIGYjgWIkjMQAzHQgSJGYjh/Adx+KvcF/eo4AAAAABJRU5ErkJggg==\"","export function scaleStage(stage, deltaY, scaleBy) {\n  const oldScale = stage.scaleX();\n  const pointer = stage.getPointerPosition();\n\n  const mousePointTo = {\n    x: (pointer.x - stage.x()) / oldScale,\n    y: (pointer.y - stage.y()) / oldScale,\n  };\n\n  const newScale = deltaY < 0 ? oldScale * scaleBy : oldScale / scaleBy;\n\n  stage.scale({ x: newScale, y: newScale });\n\n  const newPos = {\n    x: pointer.x - mousePointTo.x * newScale,\n    y: pointer.y - mousePointTo.y * newScale,\n  };\n  stage.position(newPos);\n  stage.batchDraw();\n}\n","import useShortcuts from \"hooks/useShortcuts\";\n\nimport Canvas from 'canvas';\n\nfunction App() {\n  const { lastShortcut } = useShortcuts();\n\n  return (\n    <div className=\"App\">\n      <Canvas lastShortcut={lastShortcut}/>\n    </div>\n  );\n}\n\nexport default App;\n","import { combineReducers } from \"redux\";\nimport undoable from \"redux-undo\";\nimport canvasReducer from \"canvas/canvasSlice\";\nimport toolReducer from \"features/tools/toolSlice\";\nimport noteReducer from \"features/note/noteSlice\";\nimport textReducer from 'features/text/textSlice';\n\nexport default combineReducers({\n  tool: toolReducer,\n  canvas: undoable(canvasReducer),\n  note: noteReducer,\n  text: textReducer\n});\n","import { configureStore } from \"@reduxjs/toolkit\";\nimport rootReducer from \"app/rootReducer\";\n\nconst store = configureStore({\n  reducer: rootReducer,\n  // middleware: (getDefaultMiddleware) =>\n  //   getDefaultMiddleware({\n  //     immutableCheck: false,\n  //     serializableCheck: false,\n  //   }),\n});\n\nexport default store;\n","import \"styles/global.scss\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport App from \"app/App\";\nimport store from \"app/store\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"note\":\"addNoteModal_note__gFYx9\",\"textarea\":\"addNoteModal_textarea__12CPn\",\"textContainer\":\"addNoteModal_textContainer__2ESK8\",\"textEdit\":\"addNoteModal_textEdit__2C1sA\",\"actions\":\"addNoteModal_actions__OuQAq\",\"colors\":\"addNoteModal_colors__iM_1T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"slider_container__2Tm_d\",\"range\":\"slider_range__1xNOW\",\"example\":\"slider_example__313gz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"settingsContainer\":\"drawSettings_settingsContainer__3BARp\",\"show\":\"drawSettings_show__1IpqZ\",\"slider\":\"drawSettings_slider__s1xYo\",\"px\":\"drawSettings_px__239md\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dragContainer\":\"draggable_dragContainer__37P1o\",\"handle\":\"draggable_handle__2zrDe\",\"keyMoving\":\"draggable_keyMoving__j1IX4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fieldset\":\"colorPicker_fieldset__B-ZSC\",\"radio\":\"colorPicker_radio__2wjUZ\",\"wrap\":\"colorPicker_wrap___SnW6\"};"],"sourceRoot":""}